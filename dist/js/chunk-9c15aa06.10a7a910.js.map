{"version":3,"sources":["webpack:///./src/components/Modal/UserChatListModal.vue?24fc","webpack:///./src/apis/socket.js","webpack:///./src/assets/image/send.svg","webpack:///./src/components/MessageBox.vue?69fa","webpack:///src/components/MessageBox.vue","webpack:///./src/components/MessageBox.vue?3945","webpack:///./src/components/MessageBox.vue","webpack:///./src/views/PrivateMessage.vue?59da","webpack:///./src/assets/image/newMessage.svg","webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./src/assets/image/conversation.svg","webpack:///./src/views/PrivateMessage.vue?52b9","webpack:///./src/components/Modal/UserChatListModal.vue?a4b5","webpack:///src/components/Modal/UserChatListModal.vue","webpack:///./src/components/Modal/UserChatListModal.vue?8ccf","webpack:///./src/components/Modal/UserChatListModal.vue","webpack:///src/views/PrivateMessage.vue","webpack:///./src/views/PrivateMessage.vue?9d1e","webpack:///./src/views/PrivateMessage.vue","webpack:///./src/components/MessageBox.vue?b2fa"],"names":["getPublicRoom","apiHelper","get","createPrivateRoom","userId","post","getPrivateRoom","getNotification","getRoom","roomId","getRoomsByUser","getAvailableUsers","getUnread","module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","on","updateScroll","_v","currentChat","_s","name","account","ref","messageList","length","_l","item","type","key","id","text","class","currentUser","UserId","attrs","_f","avatar","message","createdAt","directives","rawName","value","expression","undefined","domProps","$event","indexOf","_k","keyCode","sendMessageHandler","target","composing","staticRenderFns","mixins","components","props","Object","default","Array","required","atPublic","Boolean","data","isProcessing","updated","methods","messageCheck","icon","title","messageCheckResult","console","log","sendMessage","messageMode","newMessage","$socket","emit","toggleIsProcessing","$refs","scrollTop","scrollHeight","watch","currentRoomId","computed","component","$","$find","find","addToUnscopables","FIND","SKIPS_HOLES","proto","forced","callbackfn","arguments","showModal","allUserList","afterUserSelected","receivedMessageList","_e","user","passChatData","lastTime","lastMessage","currentMessageList","_m","closeModal","userSelected","Spinner","$emit","document","body","removeChild","modalBackdrops","deep","handler","sockets","createNewChat","joinPrivateRoom","username"],"mappings":"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","file":"js/chunk-9c15aa06.10a7a910.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserChatListModal.vue?vue&type=style&index=0&id=e3f63714&scoped=true&lang=css&\"","import { apiHelper } from './../utils/helpers'\n\nexport default {\n  getPublicRoom() {\n    // getPublicRoom\n    return apiHelper.get('/rooms/4')\n  },\n  createPrivateRoom(userId) {\n    return apiHelper.post('/rooms', { userId })\n  },\n  // 未完成\n  getPrivateRoom(userId) {\n    return apiHelper.get(`/rooms/${userId}`)\n  },\n  getNotification() {\n    return apiHelper.get('/rooms/notifications')\n  },\n  getRoom(roomId) {\n    return apiHelper.get(`/rooms/${roomId}`)\n  },\n  getRoomsByUser() {\n    // get all chats by rooms\n    return apiHelper.get('/rooms')\n  },\n  getAvailableUsers() {\n    return apiHelper.get('rooms/availableUsers')\n  },\n  getUnread() {\n    return apiHelper.get('/private/unread')\n  }\n}","module.exports = __webpack_public_path__ + \"img/send.44ccdf6b.svg\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"messageBox\"},[(_vm.atPublic)?[_c('div',{staticClass:\"title\",on:{\"click\":_vm.updateScroll}},[_c('h1',[_vm._v(\"公開聊天室\")])])]:[(_vm.currentChat.name)?_c('div',{staticClass:\"title private\"},[_c('h1',[_vm._v(_vm._s(_vm.currentChat.name ? _vm.currentChat.name : \"UserName\"))]),_c('p',[_vm._v(\"@\"+_vm._s(_vm.currentChat.account ? _vm.currentChat.account : \"UserAccount\"))])]):_c('div',{staticClass:\"title noChat\"},[_c('h1',[_vm._v(\"開啟聊天！\")])])],_c('div',{ref:\"messageList\",staticClass:\"container\"},[_c('ul',{staticClass:\"messageList\"},[(_vm.isProcessing)?_c('Spinner'):[(!_vm.messageList.length)?_c('div',{staticClass:\"emptyList\"},[_c('img',{attrs:{\"src\":require(\"../assets/image/conversation.svg\"),\"alt\":\"\"}})]):_vm._l((_vm.messageList),function(item){return [(item.type === 0)?_c('li',{key:item.id,staticClass:\"actionItem\"},[_c('p',[_vm._v(_vm._s(item.text))])]):_c('li',{key:item.id,staticClass:\"messageItem\",class:{ currentUser: item.UserId === _vm.currentUser.id }},[_c('div',{staticClass:\"mainContent\"},[_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":_vm._f(\"emptyImageFilter\")(item.avatar),\"alt\":\"\"}})]),_c('div',{staticClass:\"textContainer\"},[_c('div',{staticClass:\"text\"},[_vm._v(\" \"+_vm._s(item.message)+\" \")])])]),_c('div',{staticClass:\"textTime\"},[_vm._v(_vm._s(_vm._f(\"fromNow\")(item.createdAt)))])])]})]],2)]),_c('div',{staticClass:\"meesagePanel\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.message),expression:\"message\"}],attrs:{\"id\":\"textInput\",\"placeholder\":\"輸入訊息...\",\"type\":\"text\",\"maxlength\":\"160\",\"required\":\"\",\"disabled\":_vm.currentChat.userId === undefined},domProps:{\"value\":(_vm.message)},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.sendMessageHandler($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.message=$event.target.value}}}),_c('button',{staticClass:\"btn sendBtn\",attrs:{\"disabled\":_vm.currentChat.userId === undefined,\"type\":\"submit\"},on:{\"click\":_vm.sendMessageHandler}},[_c('img',{attrs:{\"src\":require(\"../assets/image/send.svg\"),\"alt\":\"\"}})])])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"messageBox\">\n    <template v-if=\"atPublic\">\n      <div class=\"title\" @click=\"updateScroll\">\n        <h1>公開聊天室</h1>\n      </div>\n    </template>\n    <template v-else>\n      <div class=\"title private\" v-if=\"currentChat.name\">\n        <h1>{{ currentChat.name ? currentChat.name : \"UserName\" }}</h1>\n        <p>@{{ currentChat.account ? currentChat.account : \"UserAccount\" }}</p>\n      </div>\n      <div v-else class=\"title noChat\">\n        <h1>開啟聊天！</h1>\n      </div>\n    </template>\n\n    <div class=\"container\" ref=\"messageList\">\n      <ul class=\"messageList\">\n        <Spinner v-if=\"isProcessing\"></Spinner>\n        <template v-else>\n          <div v-if=\"!messageList.length\" class=\"emptyList\">\n            <img src=\"../assets/image/conversation.svg\" alt=\"\" />\n          </div>\n          <!--  -->\n          <template v-else v-for=\"item of messageList\">\n            <!-- actionItem -->\n            <li v-if=\"item.type === 0\" class=\"actionItem\" :key=\"item.id\">\n              <p>{{ item.text }}</p>\n            </li>\n\n            <!-- messageItem: others -->\n            <li\n              v-else\n              class=\"messageItem\"\n              :key=\"item.id\"\n              :class=\"{ currentUser: item.UserId === currentUser.id }\"\n            >\n              <div class=\"mainContent\">\n                <div class=\"avatar\">\n                  <img :src=\"item.avatar | emptyImageFilter\" alt=\"\" />\n                </div>\n                <div class=\"textContainer\">\n                  <div class=\"text\">\n                    {{ item.message }}\n                  </div>\n                </div>\n              </div>\n              <div class=\"textTime\">{{ item.createdAt | fromNow }}</div>\n            </li>\n          </template></template\n        >\n      </ul>\n    </div>\n    <div class=\"meesagePanel\">\n      <input\n        @keyup.enter=\"sendMessageHandler\"\n        id=\"textInput\"\n        placeholder=\"輸入訊息...\"\n        type=\"text\"\n        v-model=\"message\"\n        maxlength=\"160\"\n        required\n        :disabled=\"currentChat.userId === undefined\"\n      />\n      <button\n        :disabled=\"currentChat.userId === undefined\"\n        type=\"submit\"\n        class=\"btn sendBtn\"\n        @click=\"sendMessageHandler\"\n      >\n        <img src=\"../assets/image/send.svg\" alt=\"\" />\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Spinner from \"./Common/Spinner\";\nimport { fromNowFilter } from \"../utils/mixins\";\nimport { emptyImageFilter } from \"../utils/mixins\";\nimport { Toast } from \"../utils/helpers\";\nimport { mapState } from \"vuex\";\n// import $ from \"jquery\";\n\nexport default {\n  name: \"MessageBox\",\n  mixins: [emptyImageFilter, fromNowFilter],\n  components: { Spinner },\n  props: {\n    currentChat: {\n      type: Object,\n      default: function () {\n        return {\n          userId: undefined,\n          name: \"\",\n          account: \"\",\n        };\n      },\n    },\n    messageList: {\n      type: Array,\n      required: true,\n    },\n    atPublic: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  data() {\n    return {\n      message: \"\",\n      isProcessing: false,\n    };\n  },\n  updated() {\n    this.updateScroll();\n  },\n  methods: {\n    messageCheck(message) {\n      if (!message.length) {\n        Toast.fire({\n          icon: \"error\",\n          title: \"尚未輸入訊息!\",\n        });\n        return false;\n      }\n      return true;\n    },\n    sendMessageHandler: function () {\n      const message = this.message;\n      const messageCheckResult = this.messageCheck(message);\n      if (!messageCheckResult) {\n        return;\n      }\n\n      const newMessage = !this.messageList.length;\n      console.log(\"atPublic: \" + this.atPublic);\n\n      const messageMode = this.atPublic\n        ? \"chat message\"\n        : \"private chat message\";\n\n      this.sendMessage(messageMode, message, newMessage);\n\n      this.message = \"\";\n\n      Toast.fire({\n        icon: \"success\",\n        title: \"訊息已發送!\",\n      });\n    },\n    sendMessage(messageMode, message, newMessage) {\n      console.log(\"messageMode: \" + messageMode);\n      console.log(\"message: \" + message);\n      console.log(\"newMessage: \" + newMessage);\n      return this.$socket.emit(\n        messageMode,\n        {\n          roomId: this.currentRoomId,\n          newMessage,\n          message,\n        },\n        () => {\n          console.log(\"currentRoomId: \" + this.currentRoomId);\n          console.log(`chat message, new: ${newMessage}`);\n        }\n      );\n    },\n    toggleIsProcessing() {\n      this.isProcessing = !this.isProcessing;\n    },\n    updateScroll() {\n      this.$refs.messageList.scrollTop = this.$refs.messageList.scrollHeight;\n    },\n  },\n  watch: {\n    currentRoomId() {\n      console.log(\"new currentRoomId: \" + this.currentRoomId);\n    },\n  },\n  computed: {\n    ...mapState([\"currentUser\", \"currentRoomId\"]),\n  },\n};\n</script>\n\n<style scoped>\n.messageBox {\n  flex: 2;\n}\n.messageBox .title {\n  border-bottom: 1px solid #e6ecf0;\n  height: 55px;\n  padding: 10px 15px;\n  display: flex;\n  align-items: center;\n  position: sticky;\n  top: 0;\n  background-color: var(--white);\n  z-index: 1;\n}\n\n.messageBox .private {\n  display: block;\n  padding: 0;\n  padding-left: 10px;\n}\n\n.private h1 {\n  height: 50%;\n  line-height: 35px;\n}\n.private p {\n  margin: 0;\n  padding: 0;\n  height: 50%;\n}\n.title h1 {\n  font-weight: 700;\n  font-size: 19px;\n  margin: 0;\n}\n\n.noChat {\n  height: 55px;\n  display: flex;\n  align-items: center;\n}\n\n.noChat h1 {\n  /* margin-top: 20px; */\n  display: inline-block;\n}\n\n/* message box */\n\n.messageBox .container {\n  padding: 0;\n  display: flex;\n  flex-direction: column;\n  height: calc(100vh - 115px);\n  overflow-y: scroll;\n}\n\n.avatar {\n  width: 50px;\n  height: 50px;\n  border: 1px solid var(--white);\n  border-radius: 50%;\n}\n.avatar img {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n}\n\n.messageBox .container::-webkit-scrollbar {\n  display: none;\n}\n\n/* for Chrome, Safari and Opera */\n.messageBox .container {\n  -ms-overflow-style: none;\n}\n\n.messageList {\n  flex: 1;\n  margin: 0;\n  /* min-height: 100%; */\n}\n\n.messageList .emptyList {\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.messageList .emptyList img {\n  min-width: 5%;\n  width: 50px;\n  height: 50px;\n}\n\n.mainContent {\n  max-width: 60%;\n  /* width: 200px; */\n  /* height: 50px; */\n  margin: 10px 10px 0 10px;\n  display: flex;\n  align-items: flex-end;\n}\n.textTime {\n  margin-left: 70px;\n  color: #777;\n  font-weight: 500;\n}\n.messageItem .avatar {\n  min-width: 50px;\n  height: 50px;\n}\n.messageItem .textContainer {\n  word-break: break-all;\n  margin-left: 10px;\n  height: 100%;\n}\n.messageItem .textContainer .text {\n  padding: 10px 15px;\n  border-radius: 20px 20px 20px 0;\n  background: #e6ecf0;\n  font-size: 16px;\n}\n.actionItem {\n  margin: 10px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n}\n.actionItem p {\n  margin: 0;\n  width: auto;\n  background-color: hsl(0deg 0% 90%);\n  color: hsl(207deg 14% 46%);\n  padding: 5px 10px;\n  border-radius: 10px;\n  font-weight: 500;\n}\n/*////////// currentUser's message ///////////*/\n.currentUser {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n}\n.currentUser .textContainer .text {\n  border-radius: 20px 20px 0 20px;\n  background-color: hsl(24deg 100% 50%);\n  color: var(--white);\n}\n.currentUser .textTime {\n  margin: 0;\n  margin: 10px 10px 0;\n}\n\n.currentUser .mainContent .avatar {\n  display: none;\n}\n\n.currentUser .textTime {\n}\n\n/*/ ////////////////// panel ///////////////*/\n.meesagePanel {\n  height: 60px;\n  padding: 10px;\n  display: flex;\n  border: 1px solid #e6ecf0;\n}\n#textInput {\n  flex: 1;\n  height: 40px;\n  outline: none;\n  border: none;\n  padding: 10px;\n  background: #e6ecf0;\n  border-radius: 10px;\n  font-size: 18px;\n  font-weight: 500;\n}\n.sendBtn {\n  width: 40px;\n  height: 40px;\n  padding: 0;\n  padding-right: 10px;\n  margin-left: 10px;\n}\n\n.sendBtn img {\n  transform: rotate(45deg);\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MessageBox.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MessageBox.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MessageBox.vue?vue&type=template&id=46389459&scoped=true&\"\nimport script from \"./MessageBox.vue?vue&type=script&lang=js&\"\nexport * from \"./MessageBox.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MessageBox.vue?vue&type=style&index=0&id=46389459&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"46389459\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateMessage.vue?vue&type=style&index=0&id=4d4981fd&scoped=true&lang=css&\"","module.exports = __webpack_public_path__ + \"img/newMessage.75e4b525.svg\";","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.es/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","module.exports = __webpack_public_path__ + \"img/conversation.3c1553d6.svg\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"publicMessage flex\"},[_c('UserSidebar'),_c('div',{staticClass:\"mainSection flex\"},[_c('div',{staticClass:\"usersOnline\"},[_c('div',{staticClass:\"title stickyTitle\"},[_c('h1',[_vm._v(\"訊息\")]),_c('div',{staticClass:\"newMessage\"},[_c('button',{staticClass:\"btn\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.showModal}},[_c('img',{attrs:{\"src\":require(\"../assets/image/newMessage.svg\"),\"alt\":\"\"}})])]),_c('UserChatListModal',{attrs:{\"allUserList\":_vm.allUserList},on:{\"afterUserSelected\":_vm.afterUserSelected}})],1),_c('div',{staticClass:\"container\"},[_c('ul',{staticClass:\"userList\"},[(_vm.isProcessing)?_c('Spinner'):[(!_vm.receivedMessageList.length)?[_c('p',{staticClass:\"noReceivedMessageList\"},[_vm._v(\"還沒有任何對話\")])]:_vm._e(),_vm._l((_vm.receivedMessageList),function(user){return _c('li',{key:user.userId,staticClass:\"userItem\",on:{\"click\":function($event){return _vm.passChatData(user)}}},[_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":_vm._f(\"emptyImageFilter\")(user.avatar),\"alt\":\"\"}})]),_c('div',{staticClass:\"userContainer\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"userName\"},[_c('p',[_vm._v(_vm._s(user.name))])]),_c('div',{staticClass:\"userAccount\"},[_c('p',[_vm._v(\"@\"+_vm._s(user.account))])]),_c('div',{staticClass:\"lastTime\"},[_c('p',[_vm._v(_vm._s(_vm._f(\"fromNow\")(user.lastTime)))])])]),_c('div',{staticClass:\"previewMessage\"},[_c('p',[_vm._v(\" \"+_vm._s(user.lastMessage)+\" \")])])])])})]],2)])]),_c('MessageBox',{ref:\"messageBox\",attrs:{\"currentChat\":_vm.currentChat,\"messageList\":_vm.currentMessageList}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"modal fade\",attrs:{\"id\":\"allUserList\",\"tabindex\":\"-1\",\"role\":\"dialog\",\"aria-labelledby\":\"\",\"aria-hidden\":\"true\"}},[_c('div',{staticClass:\"modal-dialog\",attrs:{\"role\":\"document\"}},[_c('div',{staticClass:\"modal-content\"},[_c('div',{staticClass:\"modal-header\"},[_vm._m(0),_c('button',{staticClass:\"start btn\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.closeModal}},[_vm._m(1)])]),_c('div',{staticClass:\"modal-body\"},[_c('ul',{staticClass:\"userList\"},[(_vm.isProcessing)?_c('Spinner',{staticClass:\"spinner\"}):_vm._l((_vm.allUserList),function(user){return _c('li',{key:user.id,staticClass:\"userItem\",on:{\"click\":function($event){return _vm.userSelected(user)}}},[_c('div',{staticClass:\"userContainer\"},[_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":_vm._f(\"emptyImageFilter\")(user.avatar),\"alt\":\"\"}})]),_c('div',{staticClass:\"userInfo\"},[_c('p',[_vm._v(_vm._s(user.name))]),_c('p',[_vm._v(\"@\"+_vm._s(user.account))])])])])})],2)]),_c('div',{staticClass:\"modal-footer\"})])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"title\"},[_c('h1',[_vm._v(\"選擇要發送訊息的用戶\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{attrs:{\"aria-hidden\":\"true\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"}},[_c('img',{attrs:{\"src\":require(\"../../assets/image/close.svg\"),\"alt\":\"\"}})])}]\n\nexport { render, staticRenderFns }","<template>\n  <div\n    class=\"modal fade\"\n    id=\"allUserList\"\n    tabindex=\"-1\"\n    role=\"dialog\"\n    aria-labelledby=\"\"\n    aria-hidden=\"true\"\n  >\n    <div class=\"modal-dialog\" role=\"document\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <div class=\"title\">\n            <h1>選擇要發送訊息的用戶</h1>\n          </div>\n          <button type=\"button\" class=\"start btn\" @click=\"closeModal\">\n            <span aria-hidden=\"true\" data-dismiss=\"modal\" aria-label=\"Close\"\n              ><img src=\"../../assets/image/close.svg\" alt=\"\"\n            /></span>\n          </button>\n        </div>\n\n        <div class=\"modal-body\">\n          <ul class=\"userList\">\n            <Spinner class=\"spinner\" v-if=\"isProcessing\"></Spinner>\n            <template v-else>\n              <li\n                class=\"userItem\"\n                v-for=\"user in allUserList\"\n                :key=\"user.id\"\n                @click=\"userSelected(user)\"\n              >\n                <div class=\"userContainer\">\n                  <div class=\"avatar\">\n                    <img :src=\"user.avatar | emptyImageFilter\" alt=\"\" />\n                  </div>\n                  <div class=\"userInfo\">\n                    <p>{{ user.name }}</p>\n                    <p>@{{ user.account }}</p>\n                  </div>\n                </div>\n              </li>\n            </template>\n          </ul>\n        </div>\n\n        <div class=\"modal-footer\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Spinner from \"../Common/Spinner\";\nimport { emptyImageFilter } from \"../../utils/mixins\";\nimport $ from \"jquery\";\n\nexport default {\n  name: \"UserChatListModal\",\n  mixins: [emptyImageFilter],\n  components: {\n    Spinner,\n  },\n  props: {\n    allUserList: {\n      type: Array,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      isProcessing: true,\n    };\n  },\n  methods: {\n    userSelected(user) {\n      console.log(\"Select userId: \" + user.id);\n      this.$emit(\"afterUserSelected\", user);\n      this.closeModal();\n    },\n    closeModal() {\n      $(\"#allUserList\").modal(\"hide\");\n      $(\".modal-backdrop\").hide();\n      const modalBackdrops = document.getElementsByClassName(\"modal-backdrop\");\n      document.body.removeChild(modalBackdrops[0]);\n    },\n  },\n  watch: {\n    allUserList: {\n      deep: true,\n      handler: function () {\n        this.isProcessing = false;\n      },\n    },\n  },\n};\n</script>\n\n<style scoped>\n.modal-content {\n  /* border: 3px solid red; */\n  width: 300px;\n  left: 50%;\n  transform: translateX(-50%);\n  top: 0px;\n}\n\n.modal-header {\n  padding: 0 15px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 55px;\n}\n\n.modal-footer {\n  height: 30px;\n}\n\n.title {\n  height: 100%;\n}\n\n.title h1 {\n  font-weight: 700;\n  font-size: 19px;\n  margin: 0;\n  line-height: 55px;\n}\n\n.modal-body {\n  padding: 0;\n}\n\n.userList {\n  margin: 0;\n}\n\n.userItem {\n  border-bottom: 1px solid #e6ecf0;\n  height: 60px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0 10px;\n}\n\n.userItem:hover {\n  cursor: pointer;\n  background-color: #f7f7f7;\n}\n\n.userContainer {\n  /* height: 60px; */\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.avatar {\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n  overflow: hidden;\n}\n\n.avatar img {\n  height: 100%;\n  width: 100%;\n}\n\n.userInfo {\n  display: flex;\n}\n\n.userInfo p {\n  margin: 0;\n  margin: 0 10px;\n  line-height: 60px;\n  font-weight: 500;\n}\n\n.userInfo p:last-child {\n  color: #657786;\n}\n\n.spinner {\n  margin: 0;\n  padding: 0;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserChatListModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserChatListModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserChatListModal.vue?vue&type=template&id=e3f63714&scoped=true&\"\nimport script from \"./UserChatListModal.vue?vue&type=script&lang=js&\"\nexport * from \"./UserChatListModal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserChatListModal.vue?vue&type=style&index=0&id=e3f63714&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e3f63714\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"publicMessage flex\">\n    <!-- UserSidebar -->\n    <UserSidebar></UserSidebar>\n\n    <!-- mainSection -->\n    <div class=\"mainSection flex\">\n      <!-- onlineUserList -->\n      <div class=\"usersOnline\">\n        <div class=\"title stickyTitle\">\n          <h1>訊息</h1>\n          <div class=\"newMessage\">\n            <button type=\"button\" class=\"btn\" @click=\"showModal\">\n              <img src=\"../assets/image/newMessage.svg\" alt=\"\" />\n            </button>\n          </div>\n\n          <!-- Modal -->\n          <UserChatListModal\n            @afterUserSelected=\"afterUserSelected\"\n            :allUserList=\"allUserList\"\n          ></UserChatListModal>\n        </div>\n        <div class=\"container\">\n          <ul class=\"userList\">\n            <Spinner v-if=\"isProcessing\"></Spinner>\n            <template v-else>\n              <template v-if=\"!receivedMessageList.length\">\n                <p class=\"noReceivedMessageList\">還沒有任何對話</p>\n              </template>\n              <template>\n                <li\n                  class=\"userItem\"\n                  v-for=\"user in receivedMessageList\"\n                  :key=\"user.userId\"\n                  @click=\"passChatData(user)\"\n                >\n                  <div class=\"avatar\">\n                    <img :src=\"user.avatar | emptyImageFilter\" alt=\"\" />\n                  </div>\n                  <div class=\"userContainer\">\n                    <div class=\"row\">\n                      <div class=\"userName\">\n                        <p>{{ user.name }}</p>\n                      </div>\n                      <div class=\"userAccount\">\n                        <p>@{{ user.account }}</p>\n                      </div>\n                      <div class=\"lastTime\">\n                        <p>{{ user.lastTime | fromNow }}</p>\n                      </div>\n                    </div>\n                    <div class=\"previewMessage\">\n                      <p>\n                        {{ user.lastMessage }}\n                      </p>\n                    </div>\n                  </div>\n                </li>\n              </template>\n            </template>\n          </ul>\n        </div>\n      </div>\n\n      <!-- messageBox -->\n      <MessageBox\n        ref=\"messageBox\"\n        :currentChat=\"currentChat\"\n        :messageList=\"currentMessageList\"\n      ></MessageBox>\n    </div>\n  </div>\n</template>\n\n<script>\nimport UserSidebar from \"../components/Common/UserSidebar\";\nimport UserChatListModal from \"../components/Modal/UserChatListModal\";\nimport MessageBox from \"../components/MessageBox\";\nimport Spinner from \"../components/Common/Spinner\";\nimport { Toast } from \"../utils/helpers\";\nimport { fromNowFilter } from \"../utils/mixins\";\nimport { emptyImageFilter } from \"../utils/mixins\";\nimport socketsAPI from \"../apis/socket\";\nimport { mapState } from \"vuex\";\nimport usersAPI from \"../apis/users\";\nimport $ from \"jquery\";\n\nexport default {\n  name: \"privateMessage\",\n  components: { UserSidebar, UserChatListModal, MessageBox, Spinner },\n  mixins: [emptyImageFilter, fromNowFilter],\n  data() {\n    return {\n      allUserList: [],\n      receivedMessageList: [],\n      currentChat: {\n        // roomId: undefined,\n        id: undefined,\n        name: \"\",\n        account: \"\",\n      },\n      currentMessageList: [],\n      message: \"\",\n      isProcessing: true,\n    };\n  },\n  async created() {\n    try {\n      await this.fetchReceivedMessageList();\n      await this.fetchAvailableUser();\n    } catch (error) {\n      console.log(error);\n    }\n  },\n  sockets: {\n    message: function (data) {\n      Toast.fire({\n        icon: \"info\",\n        title: data.text,\n      });\n      console.log(data);\n    },\n    \"private chat message\": async function (msg) {\n      console.log(\"private chat message: \" + msg);\n\n      // 1. if msg.userId === currentUser.id, me sending msg to others\n      if (msg.userId === this.currentUser.id) {\n        // 2. use currentChat.userId to update messageRoom\n        // see if messageRoom existes\n        const messageRoom = this.receivedMessageList.find(\n          (room) => room.roomId === this.currentRoomId\n        );\n        // newMessageRoom existes: not first time, update messageRoom\n        if (messageRoom) {\n          messageRoom.lastTime = msg.createdAt;\n          messageRoom.lastMessage = msg.text;\n        } else {\n          // newMessageRoom doesn't existe: first time, create messageRoom\n          this.receivedMessageList.push({\n            account: this.currentChat.account,\n            avatar: this.currentChat.avatar,\n            lastMessage: msg.text,\n            lastTime: msg.createdAt,\n            name: this.currentChat.name,\n            userId: this.currentChat.id,\n            roomId: this.currentRoomId,\n          });\n        }\n        // update messageBox, cause we are surely inside.\n        this.currentMessageList.push({\n          id: this.currentMessageList.length + 1,\n          UserId: this.currentUser.id,\n          type: 1, // messageItem\n          avatar: this.currentUser.avatar,\n          message: msg.text,\n          createdAt: msg.createdAt,\n        });\n      } else {\n        // receiving others msg\n        const messageRoom = this.receivedMessageList.find(\n          (room) => room.userId === msg.userId // 也要判斷 roomId，看是否是給自己的訊息\n        );\n        // messageRoom must existe: otherwise it'll be new private chat, update messageRoom\n        messageRoom.lastTime = msg.createdAt;\n        messageRoom.lastMessage = msg.text;\n        // if we are at the room, update messageList\n        if (this.currentRoomId === messageRoom.roomId) {\n          this.currentMessageList.push({\n            id: this.currentMessageList.length + 1,\n            UserId: this.currentChat.userId,\n            type: 1, // messageItem\n            avatar: this.currentChat.avatar,\n            message: msg.text,\n            createdAt: msg.createdAt,\n          });\n        }\n      }\n    },\n    \"users count\": function (data) {\n      console.log(\"Users count: \");\n      console.log(data);\n    },\n    // ERROR: 對方收到訊息的時候沒有正確建立 receivedMessage 或新增 message\n    \"new private chat message\": async function (response) {\n      // get new chat\n      console.log(\"create new room!\");\n      const roomId = response[1];\n      // response[0]:\n      const {\n        avatar,\n        createdAt: lastTime,\n        text: lastMessage,\n        userId,\n      } = response[0];\n\n      // fetch userInfo\n      try {\n        const { data } = await usersAPI.getUser(userId);\n        const { name, account } = data;\n\n        // ///////////\n        // create new room to receivedMessageList\n\n        this.receivedMessageList.push({\n          account,\n          avatar,\n          userId,\n          lastMessage,\n          lastTime,\n          roomId,\n          name,\n        });\n\n        this.currentChat.message.push(response);\n      } catch (error) {\n        console.log(\"new private chat message: \" + error);\n      }\n    },\n    \"notice from private\": function (data) {\n      console.log(data);\n    },\n  },\n  methods: {\n    async fetchReceivedMessageList() {\n      try {\n        this.isProcessing = true;\n        const { data } = await socketsAPI.getRoomsByUser();\n\n        // 把 userId 一樣的訊息裝成一包放進 receivedMessageList\n        this.receivedMessageList = data.map((each) => {\n          const {\n            userId,\n            name,\n            account,\n            avatar,\n            roomId,\n            message,\n            createdAt,\n          } = each;\n          return {\n            userId,\n            name,\n            account,\n            avatar,\n            roomId,\n            lastTime: createdAt,\n            lastMessage: message,\n          };\n        });\n        this.isProcessing = false;\n      } catch (error) {\n        this.isProcessing = false;\n        console.log(\"fetchChatData\");\n        console.log(error);\n      }\n    },\n\n    // click old chat, fetch chat data, join room\n    async passChatData(user) {\n      const { roomId, userId } = user;\n\n      if (this.currentChat.userId === userId) {\n        console.log(\"[PrivateMessage] Already in the message box!\");\n        return;\n      }\n\n      console.log(\"[PrivateMessage] passing Chat Data to message box\");\n      // user => account, avatar, lastMessage, lastTime, name, roomId, userId\n      this.currentChat = user;\n\n      // tell messageBox to show \"processing\"\n      this.$refs.messageBox.toggleIsProcessing();\n\n      // if already in certain room\n      if (this.currentRoomId) {\n        console.log(\"leave room: \" + this.currentRoomId);\n        this.$socket.emit(\"leave\", this.currentUser.id, this.currentRoomId);\n        this.$store.commit(\"setCurrentRoomId\", undefined);\n      }\n\n      try {\n        const { data } = await socketsAPI.getRoom(roomId);\n        const { messages } = data;\n        this.currentMessageList = messages.map((msg) => {\n          return {\n            ...msg,\n            type: 1,\n          };\n        });\n\n        // tell messageBox to show \"processing\"\n        this.$refs.messageBox.toggleIsProcessing();\n\n        // join room\n        console.log(\"join room:\" + roomId);\n        this.joinPrivateRoom(roomId);\n        this.$store.commit(\"setCurrentRoomId\", roomId);\n      } catch (error) {\n        console.log(error);\n        Toast.fire({\n          icon: \"error\",\n          title: error,\n        });\n      }\n    },\n\n    // Step1: select new chat\n    afterUserSelected(user) {\n      this.currentMessageList = [];\n      this.currentChat = {\n        ...this.currentChat,\n        ...user,\n        userId: user.id,\n      };\n      const userId = this.currentChat.id;\n      this.createNewChat(userId);\n    },\n    // Step2: create new chat room\n    async createNewChat(userId) {\n      try {\n        const { data } = await socketsAPI.createPrivateRoom(userId);\n        const { roomId } = data;\n\n        console.log(data);\n        console.log(\"RoomId: \" + roomId);\n\n        if (data.status !== \"success\") {\n          throw new Error(data.message);\n        }\n\n        Toast.fire({\n          icon: \"success\",\n          title: \"已建立連線！\",\n        });\n\n        this.$socket.emit(\"leave\", this.currentUser.id, this.currentRoomId);\n        this.joinPrivateRoom(roomId);\n\n        this.$store.commit(\"setCurrentRoomId\", roomId);\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    // Step3: currentUser join chat room\n    joinPrivateRoom(roomId) {\n      // session update check\n      // const { rooms } = JSON.parse(sessionStorage.getItem(\"rooms\"));\n      // const sessionRoomId = rooms[2];\n      // if (sessionRoomId !== roomId) {\n      //   console.log(\"Session update needed!\");\n      //   // this.$bus.$emit(\"updateSession\", roomId);\n      // }\n\n      console.log(\"join private room: \" + roomId);\n\n      // this.$bus.$emit(\"updateSession\", roomId);\n\n      this.$socket.emit(\"join\", {\n        username: this.currentUser.name,\n        roomId,\n        userId: this.currentUser.id,\n      });\n    },\n    async fetchAvailableUser() {\n      try {\n        const { data } = await socketsAPI.getAvailableUsers();\n\n        this.allUserList = data;\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    showModal() {\n      $(\"#allUserList\").appendTo(\"body\");\n      $(\"#allUserList\").modal(\"show\");\n    },\n  },\n  computed: {\n    ...mapState([\"currentUser\", \"currentRoomId\"]),\n  },\n};\n</script>\n\n<style scoped>\n.usersOnline {\n  border-right: 1px solid #e6ecf0;\n  flex: 1;\n  min-width: 400px;\n  position: relative;\n}\n\n.messageBox {\n  flex: 2;\n}\n\n.usersOnline .title,\n.messageBox .title {\n  z-index: 1;\n}\n\n.messageBox .title {\n  padding: 0;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: center;\n  padding: 0 10px;\n}\n\n.messageBox .title p {\n  margin: 0;\n  color: hsl(207deg 14% 46%);\n}\n\n.newMessage {\n  /* border: 1px solid #000; */\n  position: absolute;\n  right: 10px;\n}\n\n.newMessage button {\n  padding: 12px;\n  width: 20px;\n  height: 20px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.newMessage img {\n  display: block;\n  width: 20px;\n  height: 20px;\n}\n\n.usersOnline .container {\n  padding: 0;\n}\n\n.noReceivedMessageList {\n  margin-top: 100px;\n  text-align: center;\n}\n\n.userItem {\n  /* border: 1px solid #000; */\n  border-bottom: 1px solid #e6ecf0;\n  padding: 0 10px;\n  height: 60px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.userItem:hover {\n  cursor: pointer;\n  background-color: #f7f7f7;\n}\n\n.avatar {\n  min-width: 50px;\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n  overflow: hidden;\n}\n\n.avatar img {\n  width: 100%;\n  height: 100%;\n}\n\n.userContainer {\n  height: 50px;\n  width: 100%;\n  flex: 1;\n  padding-left: 10px;\n  display: flex;\n  flex-direction: column;\n}\n\n.userContainer .row {\n  margin: 0;\n  height: 25px;\n  overflow-x: hidden;\n  position: relative;\n}\n\n.previewMessage {\n  max-width: 90%;\n  width: 90%;\n  height: 25px;\n  overflow: hidden;\n}\n\n.lastTime p,\n.userName p,\n.userAccount p {\n  line-height: 25px;\n  font-size: 14px;\n  margin: 0;\n}\n\n.userName p {\n  font-weight: 700;\n}\n\n.previewMessage p,\n.userAccount p,\n.lastTime p {\n  color: #657786;\n  font-weight: 500;\n}\n\n.userAccount {\n  margin-left: 5px;\n}\n\n.userAccount p,\n.userName p,\n.previewMessage p {\n  margin: 0;\n}\n\n.lastTime {\n  position: absolute;\n  right: 0;\n}\n\n.previewMessage p {\n  line-height: 25px;\n  width: 100px;\n}\n\n/*/////////////////// message box ///////////////////*/\n\n.messageBox .container {\n  padding: 0;\n  display: flex;\n  flex-direction: column;\n  height: calc(100vh - 115px);\n  overflow-y: scroll;\n}\n\n.messageBox .container::-webkit-scrollbar {\n  display: none;\n}\n\n/* for Chrome, Safari and Opera */\n.messageBox .container {\n  -ms-overflow-style: none;\n}\n\n.messageList {\n  flex: 1;\n  margin: 0;\n}\n\n.mainContent {\n  max-width: 60%;\n  /* width: 200px; */\n  /* height: 50px; */\n  margin: 10px 10px 0 10px;\n  display: flex;\n  align-items: flex-end;\n}\n\n.textTime {\n  margin-left: 70px;\n  color: #777;\n  font-weight: 500;\n}\n\n.messageItem .avatar {\n  min-width: 50px;\n  width: 50px;\n  height: 50px;\n}\n.messageItem .textContainer {\n  word-break: break-all;\n  margin-left: 10px;\n  height: 100%;\n}\n\n.messageItem .textContainer .text {\n  padding: 10px 15px;\n  border-radius: 20px 20px 20px 0;\n  background: #e6ecf0;\n  font-size: 16px;\n}\n\n.actionItem {\n  margin: 10px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n}\n\n.actionItem p {\n  margin: 0;\n  width: auto;\n  background-color: hsl(0deg 0% 90%);\n  color: hsl(207deg 14% 46%);\n  padding: 5px 10px;\n  border-radius: 10px;\n  font-weight: 500;\n}\n\n/*////////// currentUser's message ///////////*/\n.currentUser {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n}\n\n.currentUser .textContainer .text {\n  border-radius: 20px 20px 0 20px;\n  background-color: hsl(24deg 100% 50%);\n  color: var(--white);\n}\n\n.currentUser .textTime {\n  /* border: 1px solid #000; */\n  margin: 0;\n  margin-right: 10px;\n}\n\n.currentUser .mainContent .avatar {\n  display: none;\n}\n\n.currentUser .textTime {\n}\n\n/*/ ////////////////// panel ///////////////*/\n.meesagePanel {\n  height: 60px;\n  padding: 10px;\n  display: flex;\n  border: 1px solid #e6ecf0;\n}\n\n#textInput {\n  flex: 1;\n  height: 40px;\n  outline: none;\n  border: none;\n  padding: 10px;\n  background: #e6ecf0;\n  border-radius: 10px;\n  font-size: 18px;\n  font-weight: 500;\n}\n\n.sendBtn {\n  width: 40px;\n  height: 40px;\n  padding: 0;\n  padding-right: 10px;\n  margin-left: 10px;\n}\n\n.sendBtn img {\n  transform: rotate(45deg);\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateMessage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateMessage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PrivateMessage.vue?vue&type=template&id=4d4981fd&scoped=true&\"\nimport script from \"./PrivateMessage.vue?vue&type=script&lang=js&\"\nexport * from \"./PrivateMessage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PrivateMessage.vue?vue&type=style&index=0&id=4d4981fd&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4d4981fd\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MessageBox.vue?vue&type=style&index=0&id=46389459&scoped=true&lang=css&\""],"sourceRoot":""}